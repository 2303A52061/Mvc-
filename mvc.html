<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Healthcare Appointments (MVC demo)</title>
  <style>
    body { font-family: Arial, sans-serif; max-width:900px; margin:30px auto; padding:0 20px; }
    header { background:#123456; color:#fff; padding:10px 16px; border-radius:6px; margin-bottom:18px; }
    .card { border:1px solid #ddd; padding:12px; border-radius:6px; margin-bottom:12px; }
    label { display:block; margin:8px 0 4px; }
    input, select { padding:8px; width:100%; box-sizing:border-box; }
    button { margin-top:10px; padding:8px 12px; border-radius:6px; cursor:pointer; }
    .appointments { margin-top:12px; }
    .appt { padding:8px; border-bottom:1px dashed #ccc; }
    .meta { font-size:12px; color:#666; }
    .github-links { margin-top:10px; }
    .badge { display:inline-block; padding:6px 8px; background:#eee; border-radius:4px; margin-right:8px; text-decoration:none; color:#222; }
  </style>
</head>
<body>
  <header>
    <h1>Healthcare Appointment Booking — MVC Demo</h1>
    <div style="font-size:13px">Client-side demo — suitable to host on GitHub Pages</div>
  </header>

  <div class="card">
    <h2>Book an appointment</h2>
    <div id="booking-form"></div>
  </div>

  <div class="card">
    <h2>Upcoming appointments</h2>
    <div id="appointments-list" class="appointments"></div>
  </div>

  <div class="card">
    <h3>Repository / Run links</h3>
    <div class="github-links">
      <!-- Replace REPO_URL with your repo link -->
      <a class="badge" href="https://github.com/USERNAME/REPO_NAME" target="_blank">View on GitHub</a>
      <!-- GitHub Pages URL example -->
      <a class="badge" href="https://USERNAME.github.io/REPO_NAME" target="_blank">Open on GitHub Pages</a>
    </div>
    <p class="meta">To serve this project on GitHub Pages: push to a repo and enable Pages in repo settings (branch: main / root or /docs).</p>
  </div>

  <script>
    /* Minimal client-side MVC implementation */
    // Model: stores appointments in localStorage
    class AppointmentModel {
      constructor(storageKey = 'appointments_v1') {
        this.key = storageKey;
        this.appointments = this._load();
        this.subscribers = [];
      }
      _load() {
        try {
          return JSON.parse(localStorage.getItem(this.key) || '[]');
        } catch (e) { return []; }
      }
      _save() {
        localStorage.setItem(this.key, JSON.stringify(this.appointments));
      }
      subscribe(fn){ this.subscribers.push(fn); }
      _notify(){ this.subscribers.forEach(fn => fn(this.appointments)); }
      add(appointment){
        appointment.id = Date.now().toString();
        this.appointments.push(appointment);
        this._save();
        this._notify();
      }
      remove(id){
        this.appointments = this.appointments.filter(a=>a.id !== id);
        this._save();
        this._notify();
      }
      clearAll(){
        this.appointments = [];
        this._save();
        this._notify();
      }
    }

    // View: renders UI
    class AppointmentView {
      constructor(rootIds) {
        this.formRoot = document.getElementById(rootIds.form);
        this.listRoot = document.getElementById(rootIds.list);
      }

      renderForm(onSubmit, onClear) {
        this.formRoot.innerHTML = `
          <label>Patient name</label>
          <input id="name" placeholder="e.g. Jane Doe" required />
          <label>Doctor</label>
          <select id="doctor">
            <option>Dr. Smith</option>
            <option>Dr. Patel</option>
            <option>Dr. Lee</option>
          </select>
          <label>Appointment date & time</label>
          <input id="datetime" type="datetime-local" />
          <button id="bookBtn">Book</button>
          <button id="clearBtn" type="button">Clear all</button>
        `;
        document.getElementById('bookBtn').addEventListener('click', (e)=> {
          e.preventDefault();
          const name = document.getElementById('name').value.trim();
          const doctor = document.getElementById('doctor').value;
          const datetime = document.getElementById('datetime').value;
          if(!name || !datetime){ alert('Please enter name and date/time.'); return; }
          onSubmit({ name, doctor, datetime });
          document.getElementById('name').value = '';
          document.getElementById('datetime').value = '';
        });
        document.getElementById('clearBtn').addEventListener('click', onClear);
      }

      renderList(appointments, onRemove) {
        if(!appointments.length) {
          this.listRoot.innerHTML = `<div class="meta">No appointments yet.</div>`;
          return;
        }
        this.listRoot.innerHTML = appointments.map(a => `
          <div class="appt">
            <strong>${a.name}</strong> — <em>${a.doctor}</em><br/>
            <span class="meta">${new Date(a.datetime).toLocaleString()}</span>
            <div style="margin-top:6px"><button data-id="${a.id}" class="rm">Cancel</button></div>
          </div>
        `).join('');
        Array.from(this.listRoot.querySelectorAll('.rm')).forEach(btn => {
          btn.addEventListener('click', () => onRemove(btn.dataset.id));
        });
      }
    }

    // Controller: wires model and view
    class AppointmentController {
      constructor(model, view) {
        this.model = model;
        this.view = view;

        // initial render
        this.view.renderForm(this.handleAdd.bind(this), this.handleClear.bind(this));
        this.model.subscribe((appts)=> this.view.renderList(appts, this.handleRemove.bind(this)));
        this.view.renderList(this.model.appointments, this.handleRemove.bind(this));
      }
      handleAdd(data) { this.model.add(data); }
      handleRemove(id) { if(confirm('Cancel this appointment?')) this.model.remove(id); }
      handleClear() { if(confirm('Clear all appointments?')) this.model.clearAll(); }
    }

    // Start app
    const appModel = new AppointmentModel();
    const appView = new AppointmentView({ form: 'booking-form', list: 'appointments-list' });
    const appController = new AppointmentController(appModel, appView);
  </script>
</body>
</html>
